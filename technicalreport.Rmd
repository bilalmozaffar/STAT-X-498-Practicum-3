---
title: "Practicum-3-group-2"
author: "Nijia Ke, "
date: "4/18/2021"
output: pdf_document
---

```{r warning=FALSE, message=FALSE}
library(imputeTS)
library(ggplot2)
library(PerformanceAnalytics)
library(ggpubr)
```

```{r}
otter = read.csv("otter2.csv", header = TRUE)

# impute the missing values for Altitude and store the values after imputation in a new variable called imp_Altitude
otter$imp_Altitude = c(na_kalman(otter$Altitude[1:20]), na_kalman(otter$Altitude[21:40]),
                       na_kalman(otter$Altitude[41:60]), na_kalman(otter$Altitude[61:80]),
                       na_kalman(otter$Altitude[81:100]))

#impute the missing values for Trout and store the values after imputation in a new variable called imp_Trout
otter$imp_Trout = c(na_kalman(otter$Trout[1:20]), na_kalman(otter$Trout[21:40]), na_kalman(otter$Trout[41:60]),
                    na_kalman(otter$Trout[61:80]), na_kalman(otter$Trout[81:100]))

##use imp_Altitude and imp_Trout instead of Altitude and Trout for the rest of analysis!!!
```

*Include explanation of data processing methods and reasoning*

```{r}
# correlation matrix for the numerical variables
corr.dat <- otter[c('imp_Altitude', 'imp_Trout', 'Caloric', 'Water.Excess', 'Amoeba', 'Water')]
chart.Correlation(corr.dat, histogram = TRUE)
```

*Thomas can you add your code here for the plot that you made with each otter's activity over time?*

```{r}
ggplot(data =otter, aes(x = Month, y = Activity)) + geom_line(mapping = aes(colour = Otter)) + labs(title = "Activity Trends Over Time", caption = "Figure 1") + theme(plot.title = element_text(hjust = 0.5))
```

Preliminary findings: RO-599 is the only otter that has an obviously non-stationary trend
 - examined mean, variance, covariance
 - we may consider detrending or differencing just this otter
 

```{r}
# plot of altitude affecting activity over time for each otter type
(alt.plot <- ggplot(otter, aes(x = imp_Altitude, y = Activity)) + geom_line(mapping = aes(colour = Otter)) +
  labs(title = 'Altitude and Activity by Otter Type', xlab = 'Altitude', ylab = 'Activity') +
  theme(plot.title = element_text(hjust = 0.5)))

# plot of trout affecting activity over time for each otter type
(trout.plot <- ggplot(otter, aes(x = imp_Trout, y = Activity)) + geom_line(mapping = aes(colour = Otter)) +
  labs(title = 'Trout and Activity by Otter Type', xlab = 'Trout', ylab = 'Activity') +
  theme(plot.title = element_text(hjust = 0.5)))

# plot of caloric affecting activity over time for each otter type
(caloric.plot <- ggplot(otter, aes(x = Caloric, y = Activity)) + geom_line(mapping = aes(colour = Otter)) +
  labs(title = 'Caloric and Activity by Otter Type', xlab = 'Caloric', ylab = 'Activity') +
  theme(plot.title = element_text(hjust = 0.5)))

# plot of water excess affecting activity over time for each otter type
(water.ex.plot <- ggplot(otter, aes(x = Water.Excess, y = Activity)) + geom_line(mapping = aes(colour = Otter)) +
  labs(title = 'Water Excess and Activity by Otter Type', xlab = 'Water Excess', ylab = 'Activity') +
  theme(plot.title = element_text(hjust = 0.5)))

# plot of amoeba affecting activity over time for each otter type
(amoeba.plot <- ggplot(otter, aes(x = Amoeba, y = Activity)) + geom_line(mapping = aes(colour = Otter)) +
  labs(title = 'Amoeba and Activity by Otter Type', xlab = 'Amoeba', ylab = 'Activity') +
  theme(plot.title = element_text(hjust = 0.5)))

# plot of water affecting activity over time for each otter type
(water.plot <- ggplot(otter, aes(x = Water, y = Activity)) + geom_line(mapping = aes(colour = Otter)) +
  labs(title = 'Water and Activity by Otter Type', xlab = 'Water', ylab = 'Activity') +
  theme(plot.title = element_text(hjust = 0.5)))
```

```{r}
# Possibly fix this line later to include all six plots together. For now, we can just use the chunk above.

# ggarrange(plotlist = alt.plot, trout.plot, caloric.plot, water.ex.plot, amoeba.plot, water.plot)
```

```{r}
otters.amoeba = subset(otter, !is.na(Amoeba))

otters.water = subset(otter, !is.na(Water))

(amoeba.plot <- ggplot(otters.amoeba, aes(x = Amoeba, y = Activity)) + geom_line(mapping = aes(colour = Otter), stat = "summary_bin", binwidth = .1) +
  labs(title = 'Amoeba and Activity by Otter Type', xlab = 'Amoeba', ylab = 'Activity') +
  theme(plot.title = element_text(hjust = 0.5)))

# plot of water affecting activity over time for each otter type
(water.plot <- ggplot(otters.water, aes(x = Water, y = Activity)) + geom_line(mapping = aes(colour = Otter), stat = "summary_bin", binwidth = .8) +
  labs(title = 'Water and Activity by Otter Type', xlab = 'Water', ylab = 'Activity') +
  theme(plot.title = element_text(hjust = 0.5)))
```

```{r}
library(tseries)

ro.599 = subset(otter, Otter == "RO-599")

#ro.599 = ro.599[,c("Activity", "Month", "Caloric", "Water.Excess", "Amoeba", "Land", "imp_Altitude", "imp_Trout")]

adf.test(diff(log(ro.599$Activity)), alternative = "stationary", k = 0)

#ARMA is oly good for univariate data
```










